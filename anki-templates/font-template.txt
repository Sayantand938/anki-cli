<div class="tag-container" id="tags"></div>
<div class="Question">{{Question}}</div>

<form id="uniqueOptionsForm" role="radiogroup">
  <label class="custom-radio">
    <input type="radio" name="option" value="1">
    <svg class="radio-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" class="radio-circle-bg" stroke-width="3"/>
    </svg>
    <span id="op1">{{OP1}}</span>
  </label>
  <label class="custom-radio">
    <input type="radio" name="option" value="2">
    <svg class="radio-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" class="radio-circle-bg" stroke-width="3"/>
    </svg>
    <span id="op2">{{OP2}}</span>
  </label>
  <label class="custom-radio">
    <input type="radio" name="option" value="3">
    <svg class="radio-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" class="radio-circle-bg" stroke-width="3"/>
    </svg>
    <span id="op3">{{OP3}}</span>
  </label>
  <label class="custom-radio">
    <input type="radio" name="option" value="4">
    <svg class="radio-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <circle cx="12" cy="12" r="10" class="radio-circle-bg" stroke-width="3"/>
    </svg>
    <span id="op4">{{OP4}}</span>
  </label>
</form>

<script>
  (function() {
    const form = document.getElementById('uniqueOptionsForm');
    const tagsContainer = document.getElementById('tags');
    const rawTags = '{{Tags}}';

    function displayFilteredTags(tagsString, containerElement) {
      const allowedPrefixes = ['MATH::', 'ENG::', 'GI::', 'GK::'];
      const allowedExactTags = ['H-1', 'H-2', 'Formula'];

      const tagsArray = tagsString.split(' ')
        .map(tag => tag.trim())
        .filter(tag => tag.length > 0)
        .filter(tag => {
          if (!tag) return false;
          if (allowedExactTags.includes(tag)) return true;
          return allowedPrefixes.some(prefix => tag.startsWith(prefix));
        });

      const tagsHtml = tagsArray.map(tag => {
        let className = 'tag';
        if (tag === 'Hard') {
          className = 'tag tag-hard';
        } else if (tag === 'Formula') {
          className = 'tag tag-formula';
        }
        return `<span class="${className}">${tag}</span>`;
      }).join('');

      if (containerElement) {
        containerElement.innerHTML = tagsHtml;
      }
    }

    if (tagsContainer && rawTags) {
      displayFilteredTags(rawTags, tagsContainer);
    }

    form.addEventListener('change', (event) => {
      if (event.target.type === 'radio' && event.target.name === 'option') {
        const selectedValue = event.target.value;
        localStorage.setItem('selectedOption', selectedValue);
        if (typeof pycmd === 'function') {
          pycmd('ans');
        }
      }
    });
  })();
</script>